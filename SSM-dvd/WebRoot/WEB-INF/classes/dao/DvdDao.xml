<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"E:\workSpace_jsp\mybatis_dvd\WebRoot\mybatis-3-mapper.dtd">
<mapper namespace="dao.DvdDao">
	<cache></cache>
	<resultMap type="entity.DvdInfo" id="dvd">
		<id column="id" property="id"/>
		<result column="name" property="name"/>
		<result column="statue" property="type"/>
		<result column="count" property="count"/>
		<result column="lenttime" property="lenttime"/>
	</resultMap>
	
	<select id="calCountdate"  resultType="int">
		SELECT COUNT(1) AS num FROM dvd
		<trim prefix="where" prefixOverrides="and | or">
			<if test="name!=null">
				and name like CONCAT ('%',#{name},'%') 
			</if>
		</trim>
	</select>
	<select id="calDate" resultMap="dvd">
		SELECT * FROM dvd
		<trim prefix="where">
			<if test="name!=null and name.trim()!=''">
				name like CONCAT ('%',#{name},'%') 
			</if>
		</trim>
		limit #{currentPage},#{pageSize}
	</select>
	<update id="addDvd">
		INSERT INTO dvd (NAME)VALUE(#{name})
	</update>
	<update id="delDvd">
		DELETE FROM dvd WHERE id=#{id}
	</update>
	<update id="updateDvd">
		UPDATE dvd SET NAME=#{name} WHERE id=#{id}
	</update>
	<update id="lendDvd">
		UPDATE dvd SET STATUS=0,lenttime=NOW(),COUNT=COUNT+1 WHERE id=#{id}
	</update>
	<update id="returnDvd">
		UPDATE dvd SET STATUS=1,lenttime=NULL WHERE id=#{id}
	</update>
</mapper>